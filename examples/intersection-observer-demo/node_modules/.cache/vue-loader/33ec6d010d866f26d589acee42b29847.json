{"remainingRequest":"/Users/evensun/vue3-app/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/evensun/vue3-app/src/App.vue?vue&type=template&id=7ba5bd90&scoped=true&ts=true","dependencies":[{"path":"/Users/evensun/vue3-app/src/App.vue","mtime":1647789324337},{"path":"/Users/evensun/vue3-app/node_modules/cache-loader/dist/cjs.js","mtime":1647691687777},{"path":"/Users/evensun/vue3-app/node_modules/babel-loader/lib/index.js","mtime":1647691687995},{"path":"/Users/evensun/vue3-app/node_modules/ts-loader/index.js","mtime":1647693675933},{"path":"/Users/evensun/vue3-app/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1647691688138},{"path":"/Users/evensun/vue3-app/node_modules/cache-loader/dist/cjs.js","mtime":1647691687777},{"path":"/Users/evensun/vue3-app/node_modules/vue-loader-v16/dist/index.js","mtime":1647691687991}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGxpbmsKICAgIGhyZWY9Imh0dHBzOi8vZm9udHMuZm9udC5pbS9jc3M/ZmFtaWx5PUtpcmFuZytIYWVyYW5nIgogICAgcmVsPSJzdHlsZXNoZWV0IgogIC8+CiAgPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5mb250LmltL2Nzcz9mYW1pbHk9Q29tZm9ydGFhIiByZWw9InN0eWxlc2hlZXQiIC8+CgogIDx2aWV3IGNsYXNzPSJkZW1vLWJvZHkiPgogICAgPGhlYWRlciBjbGFzcz0iZGVtby1oZWFkZXIiPkludGVyc2VjdGlvbiBPYnNlcnZlciBEZW1vPC9oZWFkZXI+CiAgICA8dmlldyBjbGFzcz0iZGVtby10YWdzIj4KICAgICAgPHZpZXcKICAgICAgICB2LWZvcj0iKHRhZywgaW5kZXgpIGluIHRhZ0xpc3QiCiAgICAgICAgOmtleT0iaW5kZXgiCiAgICAgICAgOmNsYXNzPSJbJ2RlbW8tdGFnJywgaW5kZXggPT0gc2VsZWN0ZXIuYWN0aXZlS2V5ID8gJ2FjdGl2ZScgOiAnJ10iCiAgICAgID4KICAgICAgICB7eyB0YWcgfX0KICAgICAgPC92aWV3PgogICAgPC92aWV3PgoKICAgIDx2aWV3IGNsYXNzPSJkZW1vLXNjcm9sbCIgaWQ9ImRlbW8tc2Nyb2xsIj4KICAgICAgPHZpZXcKICAgICAgICB2LWZvcj0iKGhlaWdodCwgaW5kZXgpIGluIGhlaWdodExpc3QiCiAgICAgICAgOmtleT0iaW5kZXgiCiAgICAgICAgY2xhc3M9ImRlbW8tYm94IgogICAgICAgIDpzdHlsZT0ieyBoZWlnaHQ6IGAke2hlaWdodH1weGAgfSIKICAgICAgICA6aWQ9ImBib3gtJHtpbmRleH1gIgogICAgICA+CiAgICAgICAge3sgaW5kZXggfX0KICAgICAgPC92aWV3PgogICAgPC92aWV3PgogIDwvdmlldz4K"},{"version":3,"sources":["/Users/evensun/vue3-app/src/App.vue"],"names":[],"mappings":"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","file":"/Users/evensun/vue3-app/src/App.vue","sourceRoot":"","sourcesContent":["<template>\n  <link\n    href=\"https://fonts.font.im/css?family=Kirang+Haerang\"\n    rel=\"stylesheet\"\n  />\n  <link href=\"https://fonts.font.im/css?family=Comfortaa\" rel=\"stylesheet\" />\n\n  <view class=\"demo-body\">\n    <header class=\"demo-header\">Intersection Observer Demo</header>\n    <view class=\"demo-tags\">\n      <view\n        v-for=\"(tag, index) in tagList\"\n        :key=\"index\"\n        :class=\"['demo-tag', index == selecter.activeKey ? 'active' : '']\"\n      >\n        {{ tag }}\n      </view>\n    </view>\n\n    <view class=\"demo-scroll\" id=\"demo-scroll\">\n      <view\n        v-for=\"(height, index) in heightList\"\n        :key=\"index\"\n        class=\"demo-box\"\n        :style=\"{ height: `${height}px` }\"\n        :id=\"`box-${index}`\"\n      >\n        {{ index }}\n      </view>\n    </view>\n  </view>\n</template>\n\n<script lang=\"ts\">\nimport { Vue, setup } from \"vue-class-component\";\nimport { onMounted, ref, reactive } from \"vue\";\n\nfunction useSelected() {\n  let activeKey = ref(0);\n\n  const tagSelected = (index: number) => {\n    activeKey.value = index;\n  };\n\n  const queue: Array<number> = reactive([]);\n  const queueSet: Set<number> = new Set();\n  const addObserver = () => {\n    const root = document.getElementById(\"#demo-scroll\");\n    let options = {\n      root,\n      threshold: [0],\n    };\n\n    const handleIntersect = (entries: any) => {\n      entries.forEach((entry: any) => {\n        \n        // 解析id\n        const id = entry?.target?.id.split(\"-\")[1] || 0;\n\n        // 相交\n        if (entry.isIntersecting) {\n          if (!queueSet.has(id)) {\n            if (queue.length > 0 && Math.abs(id - queue[queue.length - 1]) !== 1) {\n              // console.log(\"reverse:\", queue);\n              queue.reverse();\n            }\n\n            queue.push(id);\n            queueSet.add(id);\n          }\n        } else {\n          if (queue.length > 0 && (activeKey.value == 0 || activeKey.value == 4) && queue[queue.length - 1] == activeKey.value) {\n            // console.log(\"reverse:\", queue);\n            queue.reverse();\n          }\n\n          if (id == queue[0]) {\n            queueSet.delete(queue[0]);\n            queue.shift();\n          }\n        }\n\n        console.log(\"queue:\", queue);\n\n        if (queue.length > 0) {\n          if (queue[queue.length - 1] == 0 || queue[queue.length - 1] == 4) {\n            activeKey.value = queue[queue.length - 1];\n          } else {\n            activeKey.value = queue[0];\n          }\n        }\n      });\n    };\n\n    const observer = new IntersectionObserver(handleIntersect, options);\n    const boxes = document.getElementsByClassName(\"demo-box\");\n    for (let i = 0; i < boxes.length; i++) {\n      observer.observe(boxes[i]);\n    }\n  };\n  \n  // 元素挂载完成的时候注册监听\n  onMounted(addObserver);\n\n  return {\n    activeKey,\n    tagSelected,\n  };\n}\n\nexport default class App extends Vue {\n  tagList = [\"tag0\", \"tag1\", \"tag2\", \"tag3\", \"tag4\"];\n  heightList = [100, 200, 400, 700, 300];\n  selecter = setup(() => useSelected());\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.demo {\n  &-box {\n    width: 100%;\n    padding: 10px 24px;\n    background: rgb(94, 217, 226);\n    display: flex;\n    box-sizing: border-box;\n    margin-bottom: 20px;\n    font-size: 50px;\n  }\n\n  &-scroll {\n    background: rgba(224, 193, 236, 0.8);\n    height: 600px;\n    width: 100%;\n    margin-top: 20px;\n    overflow-y: scroll;\n  }\n\n  &-header {\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    font-family: \"Kirang Haerang\", cursive;\n    font-size: 50px;\n    margin-top: 20px;\n  }\n\n  &-body {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-content: center;\n    width: 600px;\n    margin: 0 auto;\n  }\n\n  &-tags {\n    display: flex;\n    flex-direction: row;\n    margin-top: 50px;\n  }\n\n  &-tag {\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-content: center;\n    padding: 8px 14px;\n    background: rgb(147, 177, 231);\n    width: 80px;\n    margin-right: 10px;\n    border-radius: 20px;\n    font-size: 20px;\n    font-family: \"Comfortaa\", cursive;\n\n    &.active {\n      background: rgb(174, 148, 245);\n      font-weight: bold;\n    }\n  }\n}\n</style>\n"]}]}